<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <script src="./lib/fx.js"></script>
    </head>
    <body>
        ## range
        <script>
            const add = (a, b) => a + b;
            const range = (l) => {
                let i = -1;
                let res = [];
                while (++i < l) {
                    // log(i, 'range');
                    res.push(i);
                }
                return res;
            };

            // 실행됐을때 이미 값이 평가되어 있음
            // array를 iterator로 만든 후 해당 iterator를 순회
            var list = range(4);
            // log(list);
            // log(reduce(add, list));
        </script>

        ## 느긋한 L.range
        <script>
            const L = {};
            L.range = function* (l) {
                let i = -1;
                while (++i < l) {
                    // log(i, 'L.range');
                    yield i;
                }
            };

            // 평가가 되지 않고 있다가, reduce 내부에서 지연평가
            // 이미 iterator이므로 iterator로 변환하는 과정을 거치지 않는다
            var list = L.range(4);
            log(list); // iterator
            log(reduce(add, list));
        </script>

        <script>
            function test(name, time, f) {
                console.time(name);
                while (time--) {
                    f();
                }
                console.timeEnd(name);
            }
            test('range', 10, () => reduce(add, range(1000000)));
            test('L.range', 10, () => reduce(add, L.range(1000000)));
        </script>
    </body>
</html>
